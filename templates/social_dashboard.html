<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Redes Sociais - Clínica Espaço Vida</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <style>
        .social-card {
            border-left: 4px solid #007bff;
            transition: transform 0.2s;
        }
        .social-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .facebook-card { border-left-color: #1877f2; }
        .instagram-card { border-left-color: #e4405f; }
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .chart-container {
            position: relative;
            height: 300px;
        }
        .message-item {
            border-left: 3px solid #dee2e6;
            padding-left: 15px;
            margin-bottom: 15px;
        }
        .message-sent { border-left-color: #28a745; }
        .message-received { border-left-color: #007bff; }
        .platform-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        .status-active { background-color: #28a745; }
        .status-inactive { background-color: #dc3545; }
        .status-pending { background-color: #ffc107; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-share-alt me-2"></i>
                Dashboard Redes Sociais
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/admin">
                    <i class="fas fa-arrow-left me-1"></i>
                    Voltar ao Admin
                </a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Resumo das Plataformas -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card social-card facebook-card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h5 class="card-title">
                                    <i class="fab fa-facebook text-primary me-2"></i>
                                    Facebook
                                </h5>
                                <p class="card-text text-muted">Messenger e Página</p>
                            </div>
                            <div class="text-end">
                                <span class="status-indicator status-active" id="facebook-status"></span>
                                <small class="text-muted">Ativo</small>
                                <div class="mt-2">
                                    <h4 class="mb-0" id="facebook-messages">0</h4>
                                    <small class="text-muted">mensagens hoje</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card social-card instagram-card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h5 class="card-title">
                                    <i class="fab fa-instagram text-danger me-2"></i>
                                    Instagram
                                </h5>
                                <p class="card-text text-muted">Direct e Comentários</p>
                            </div>
                            <div class="text-end">
                                <span class="status-indicator status-active" id="instagram-status"></span>
                                <small class="text-muted">Ativo</small>
                                <div class="mt-2">
                                    <h4 class="mb-0" id="instagram-messages">0</h4>
                                    <small class="text-muted">mensagens hoje</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Métricas Gerais -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="card-body text-center">
                        <i class="fas fa-comments fa-2x mb-2"></i>
                        <h3 class="mb-0" id="total-messages">0</h3>
                        <small>Total de Mensagens</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="card-body text-center">
                        <i class="fas fa-users fa-2x mb-2"></i>
                        <h3 class="mb-0" id="unique-users">0</h3>
                        <small>Usuários Únicos</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="card-body text-center">
                        <i class="fas fa-reply fa-2x mb-2"></i>
                        <h3 class="mb-0" id="response-rate">0%</h3>
                        <small>Taxa de Resposta</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="card-body text-center">
                        <i class="fas fa-user-plus fa-2x mb-2"></i>
                        <h3 class="mb-0" id="new-leads">0</h3>
                        <small>Novos Leads</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Abas de Conteúdo -->
        <ul class="nav nav-tabs" id="socialTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="messages-tab" data-bs-toggle="tab" data-bs-target="#messages" type="button" role="tab">
                    <i class="fas fa-comments me-2"></i>Mensagens
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="analytics-tab" data-bs-toggle="tab" data-bs-target="#analytics" type="button" role="tab">
                    <i class="fas fa-chart-line me-2"></i>Analytics
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="leads-tab" data-bs-toggle="tab" data-bs-target="#leads" type="button" role="tab">
                    <i class="fas fa-user-plus me-2"></i>Leads
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="campaigns-tab" data-bs-toggle="tab" data-bs-target="#campaigns" type="button" role="tab">
                    <i class="fas fa-bullhorn me-2"></i>Campanhas
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab">
                    <i class="fas fa-cog me-2"></i>Configurações
                </button>
            </li>
        </ul>

        <div class="tab-content" id="socialTabsContent">
            <!-- Aba Mensagens -->
            <div class="tab-pane fade show active" id="messages" role="tabpanel">
                <div class="card mt-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Mensagens Recentes</h5>
                        <div>
                            <select class="form-select form-select-sm" id="platform-filter">
                                <option value="">Todas as plataformas</option>
                                <option value="facebook">Facebook</option>
                                <option value="instagram">Instagram</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="messages-list">
                            <!-- Mensagens serão carregadas aqui -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Analytics -->
            <div class="tab-pane fade" id="analytics" role="tabpanel">
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Mensagens por Dia</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="messagesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Distribuição por Plataforma</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="platformChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Leads -->
            <div class="tab-pane fade" id="leads" role="tabpanel">
                <div class="card mt-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Leads das Redes Sociais</h5>
                        <button class="btn btn-primary btn-sm" onclick="exportLeads()">
                            <i class="fas fa-download me-1"></i>Exportar
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Plataforma</th>
                                        <th>Nome</th>
                                        <th>Contato</th>
                                        <th>Status</th>
                                        <th>Data</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="leads-table">
                                    <!-- Leads serão carregados aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Campanhas -->
            <div class="tab-pane fade" id="campaigns" role="tabpanel">
                <div class="card mt-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Campanhas Ativas</h5>
                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#campaignModal">
                            <i class="fas fa-plus me-1"></i>Nova Campanha
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="campaigns-list">
                            <!-- Campanhas serão carregadas aqui -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Configurações -->
            <div class="tab-pane fade" id="settings" role="tabpanel">
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Configurações do Facebook</h5>
                            </div>
                            <div class="card-body">
                                <form id="facebook-config-form">
                                    <div class="mb-3">
                                        <label class="form-label">App ID</label>
                                        <input type="text" class="form-control" name="app_id" placeholder="Seu Facebook App ID">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">App Secret</label>
                                        <input type="password" class="form-control" name="app_secret" placeholder="Seu Facebook App Secret">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Access Token</label>
                                        <input type="text" class="form-control" name="access_token" placeholder="Seu Page Access Token">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Verify Token</label>
                                        <input type="text" class="form-control" name="verify_token" placeholder="Token de verificação do webhook">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Page ID</label>
                                        <input type="text" class="form-control" name="page_id" placeholder="ID da sua página">
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Salvar
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Configurações do Instagram</h5>
                            </div>
                            <div class="card-body">
                                <form id="instagram-config-form">
                                    <div class="mb-3">
                                        <label class="form-label">Access Token</label>
                                        <input type="text" class="form-control" name="access_token" placeholder="Seu Instagram Access Token">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Business Account ID</label>
                                        <input type="text" class="form-control" name="business_account_id" placeholder="ID da conta business">
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="auto_reply" id="auto-reply">
                                            <label class="form-check-label" for="auto-reply">
                                                Resposta automática ativa
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="comment_monitoring" id="comment-monitoring">
                                            <label class="form-check-label" for="comment-monitoring">
                                                Monitorar comentários
                                            </label>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Salvar
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mt-3">
                    <div class="card-header">
                        <h5 class="mb-0">Webhook URLs</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Facebook Webhook URL:</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" value="https://seudominio.com/social/facebook/webhook" readonly>
                                    <button class="btn btn-outline-secondary" onclick="copyToClipboard(this.previousElementSibling.value)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Instagram Webhook URL:</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" value="https://seudominio.com/social/instagram/webhook" readonly>
                                    <button class="btn btn-outline-secondary" onclick="copyToClipboard(this.previousElementSibling.value)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nova Campanha -->
    <div class="modal fade" id="campaignModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Nova Campanha</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="campaign-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nome da Campanha</label>
                                    <input type="text" class="form-control" name="name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tipo</label>
                                    <select class="form-select" name="type" required>
                                        <option value="">Selecione...</option>
                                        <option value="promotional">Promocional</option>
                                        <option value="informational">Informativa</option>
                                        <option value="engagement">Engajamento</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Público-alvo</label>
                            <textarea class="form-control" name="target_audience" rows="2" placeholder="Descreva o público-alvo da campanha"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Template da Mensagem</label>
                            <textarea class="form-control" name="message_template" rows="4" placeholder="Digite o template da mensagem que será enviada"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Data de Início</label>
                                    <input type="date" class="form-control" name="start_date">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Data de Fim</label>
                                    <input type="date" class="form-control" name="end_date">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="createCampaign()">Criar Campanha</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variáveis globais
        let messagesChart, platformChart;

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
            loadMessages();
            loadLeads();
            initCharts();
            
            // Atualizar dados a cada 30 segundos
            setInterval(loadDashboardData, 30000);
        });

        // Carregar dados do dashboard
        function loadDashboardData() {
            // Carregar analytics do Facebook
            fetch('/social/analytics/facebook')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById('facebook-messages').textContent = data.analytics.total_messages || 0;
                        updateMetrics('facebook', data.analytics);
                    }
                })
                .catch(error => console.error('Erro ao carregar dados do Facebook:', error));

            // Carregar analytics do Instagram
            fetch('/social/analytics/instagram')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById('instagram-messages').textContent = data.analytics.total_messages || 0;
                        updateMetrics('instagram', data.analytics);
                    }
                })
                .catch(error => console.error('Erro ao carregar dados do Instagram:', error));
        }

        // Atualizar métricas gerais
        function updateMetrics(platform, analytics) {
            const totalMessages = parseInt(document.getElementById('total-messages').textContent) + (analytics.total_messages || 0);
            const uniqueUsers = parseInt(document.getElementById('unique-users').textContent) + (analytics.unique_users || 0);
            
            document.getElementById('total-messages').textContent = totalMessages;
            document.getElementById('unique-users').textContent = uniqueUsers;
            document.getElementById('response-rate').textContent = (analytics.response_rate || 0) + '%';
        }

        // Carregar mensagens
        function loadMessages() {
            const platform = document.getElementById('platform-filter').value;
            const url = platform ? `/social/analytics/${platform}` : '/social/analytics/facebook';
            
            // Simular carregamento de mensagens
            const messagesList = document.getElementById('messages-list');
            messagesList.innerHTML = `
                <div class="message-item message-received">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <strong>João Silva</strong>
                            <span class="badge bg-primary platform-badge ms-2">Facebook</span>
                            <p class="mb-1 mt-2">Olá! Gostaria de agendar uma consulta.</p>
                            <small class="text-muted">Há 5 minutos</small>
                        </div>
                        <button class="btn btn-sm btn-outline-primary" onclick="replyMessage('facebook', 'user123')">
                            <i class="fas fa-reply"></i>
                        </button>
                    </div>
                </div>
                <div class="message-item message-sent">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <strong>Bot</strong>
                            <span class="badge bg-success platform-badge ms-2">Resposta Automática</span>
                            <p class="mb-1 mt-2">Olá João! 👋 Para agendar sua consulta, ligue (11) 1234-5678 ou acesse nosso site.</p>
                            <small class="text-muted">Há 4 minutos</small>
                        </div>
                    </div>
                </div>
                <div class="message-item message-received">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <strong>Maria Santos</strong>
                            <span class="badge bg-danger platform-badge ms-2">Instagram</span>
                            <p class="mb-1 mt-2">Qual o horário de funcionamento?</p>
                            <small class="text-muted">Há 15 minutos</small>
                        </div>
                        <button class="btn btn-sm btn-outline-primary" onclick="replyMessage('instagram', 'user456')">
                            <i class="fas fa-reply"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        // Carregar leads
        function loadLeads() {
            fetch('/social/leads')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const leadsTable = document.getElementById('leads-table');
                        leadsTable.innerHTML = '';
                        
                        data.leads.forEach(lead => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>
                                    <span class="badge bg-${lead.platform === 'facebook' ? 'primary' : 'danger'}">
                                        ${lead.platform === 'facebook' ? 'Facebook' : 'Instagram'}
                                    </span>
                                </td>
                                <td>${lead.user_name || 'N/A'}</td>
                                <td>
                                    ${lead.user_email || ''}
                                    ${lead.user_phone ? '<br><small>' + lead.user_phone + '</small>' : ''}
                                </td>
                                <td>
                                    <span class="badge bg-${getStatusColor(lead.lead_status)}">
                                        ${getStatusText(lead.lead_status)}
                                    </span>
                                </td>
                                <td>${formatDate(lead.created_at)}</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary" onclick="viewLead(${lead.id})">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </td>
                            `;
                            leadsTable.appendChild(row);
                        });
                        
                        document.getElementById('new-leads').textContent = data.leads.filter(l => l.lead_status === 'new').length;
                    }
                })
                .catch(error => console.error('Erro ao carregar leads:', error));
        }

        // Inicializar gráficos
        function initCharts() {
            // Gráfico de mensagens por dia
            const messagesCtx = document.getElementById('messagesChart').getContext('2d');
            messagesChart = new Chart(messagesCtx, {
                type: 'line',
                data: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    datasets: [{
                        label: 'Facebook',
                        data: [12, 19, 15, 25, 22, 18, 8],
                        borderColor: '#1877f2',
                        backgroundColor: 'rgba(24, 119, 242, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Instagram',
                        data: [8, 15, 12, 18, 16, 14, 6],
                        borderColor: '#e4405f',
                        backgroundColor: 'rgba(228, 64, 95, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Gráfico de distribuição por plataforma
            const platformCtx = document.getElementById('platformChart').getContext('2d');
            platformChart = new Chart(platformCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Facebook', 'Instagram'],
                    datasets: [{
                        data: [65, 35],
                        backgroundColor: ['#1877f2', '#e4405f'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Responder mensagem
        function replyMessage(platform, userId) {
            const message = prompt('Digite sua resposta:');
            if (message) {
                fetch('/social/send-message', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        platform: platform,
                        recipient_id: userId,
                        message: message
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Mensagem enviada com sucesso!');
                        loadMessages();
                    } else {
                        alert('Erro ao enviar mensagem: ' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    alert('Erro ao enviar mensagem');
                });
            }
        }

        // Criar campanha
        function createCampaign() {
            const form = document.getElementById('campaign-form');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);

            fetch('/social/campaigns', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Campanha criada com sucesso!');
                    bootstrap.Modal.getInstance(document.getElementById('campaignModal')).hide();
                    form.reset();
                } else {
                    alert('Erro ao criar campanha: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao criar campanha');
            });
        }

        // Exportar leads
        function exportLeads() {
            window.open('/social/leads?export=csv', '_blank');
        }

        // Copiar para clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('URL copiada para a área de transferência!');
            });
        }

        // Funções auxiliares
        function getStatusColor(status) {
            switch(status) {
                case 'new': return 'primary';
                case 'contacted': return 'warning';
                case 'converted': return 'success';
                case 'lost': return 'danger';
                default: return 'secondary';
            }
        }

        function getStatusText(status) {
            switch(status) {
                case 'new': return 'Novo';
                case 'contacted': return 'Contatado';
                case 'converted': return 'Convertido';
                case 'lost': return 'Perdido';
                default: return 'Desconhecido';
            }
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('pt-BR');
        }

        function viewLead(leadId) {
            // Implementar visualização detalhada do lead
            alert('Visualizar lead ID: ' + leadId);
        }

        // Event listeners
        document.getElementById('platform-filter').addEventListener('change', loadMessages);
    </script>
</body>
</html>